import zmq
import uuid
import otestpoint.time.ntp_pb2 as ntp_pb2

context = zmq.Context()

subscriber = context.socket(zmq.SUB)

subscriber.connect("tcp://localhost:9002")

subscriber.setsockopt(zmq.SUBSCRIBE,"Measurement_system_ntp")

while True:
	msgs = subscriber.recv_multipart()

	report = ntp_pb2.NTP()

	report.ParseFromString(msgs[1])

	print "probe name:", msgs[0]
	print "timestamp:",report.timestamp
	print "tag:", report.tag
	print "index", report.index
	print "uuid", uuid.UUID(bytes=report.uuid)
	print "data name", report.data.name
	print "data module", report.data.module
	print "data version", report.data.version
	print "data length", len(report.data.blob)
	print
